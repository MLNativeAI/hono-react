name: Lint & Typecheck

on:
  workflow_call:
  push:
    branches: ['**']
  pull_request:
    branches: [main]

jobs:
  lint-typecheck:
    name: Lint & Typecheck
    runs-on: ubuntu-latest
    permissions:
      contents: read
      packages: write
      id-token: write

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Setup Node.js and Bun
      uses: ./.github/actions/setup-node-bun
      with:
        node-version: 24
        bun-version: latest

    - name: Setup UV
      uses: ./.github/actions/setup-uv
      with:
        enable-cache: true
        working-directory: apps/docx-py
    - uses: astral-sh/ruff-action@v3
    - name: Install Python dependencies
      run: uv sync
      working-directory: apps/docx-py

    - name: Install dependencies
      run: bun install

    - name: Lint
      run: bun run lint

    - name: Typecheck
      run: bun run typecheck
  #
  # python-lint-typecheck:
  #   name: Python Lint & Typecheck
  #   runs-on: ubuntu-latest
  #   permissions:
  #     contents: read
  #     packages: write
  #     id-token: write
  #
  #   steps:
  #   - name: Checkout repository
  #     uses: actions/checkout@v4
  #
  #   - name: Setup UV
  #     uses: ./.github/actions/setup-uv
  #     with:
  #       enable-cache: true
  #       working-directory: apps/docx-py
  #   - uses: astral-sh/ruff-action@v3
  #   - name: Install Python dependencies
  #     run: uv sync
  #     working-directory: apps/docx-py
  #
  #   - name: Python lint
  #     run: uv run ruff check .
  #     working-directory: apps/docx-py
  #
  #   - name: Python typecheck
  #     run: uv run mypy src
  #     working-directory: apps/docx-py
